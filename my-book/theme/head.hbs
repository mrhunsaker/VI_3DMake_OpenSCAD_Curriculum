
<!-- Highlight.js CSS -->
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">

<!-- Highlight.js Core -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

<!-- Load your custom JAWSScript syntax (loaded via JS so path works on GitHub Pages) -->
<script>
  (function(){
    function computeBase() {
      try {
        const link = Array.from(document.getElementsByTagName('link')).find(l => l.href && l.href.match(/\/css\/variables-.*\.css$/));
        if (link) {
          const u = new URL(link.href, window.location.href);
          const basePath = u.pathname.replace(/\/css\/.*$/,'');
          return u.origin + basePath + (basePath.endsWith('/') ? '' : '/');
        }
      } catch (e) {}
      return (window.location.origin || '') + '/';
    }
    const root = computeBase();
    const s = document.createElement('script');
    s.src = root + 'assets/jaws.js';
    s.defer = true;
    document.head.appendChild(s);
  })();
</script>

<script>
  (function(){
    // Load Atkinson Hyperlegible fonts from the book assets (injected at runtime so paths are correct on GitHub Pages)
    try {
      const link = Array.from(document.getElementsByTagName('link')).find(l => l.href && l.href.match(/\/css\/variables-.*\.css$/));
      const base = (function(){
        if (!link) return (window.location.origin||'') + '/';
        const u = new URL(link.href, window.location.href);
        const basePath = u.pathname.replace(/\/css\/.*$/,'');
        return u.origin + basePath + (basePath.endsWith('/') ? '' : '/');
      })();

      const css = `\
@font-face {\
  font-family: 'Atkinson Hyperlegible Next';\
  src: url('${base}assets/fonts/AtkinsonHyperlegibleNext-Regular.ttf') format('truetype');\
  font-weight: 400; font-style: normal; font-display: swap;\
}\
@font-face {\
  font-family: 'Atkinson Hyperlegible Mono';\
  src: url('${base}assets/fonts/AtkinsonHyperlegibleMono-SemiBold.ttf') format('truetype');\
  font-weight: 600; font-style: normal; font-display: swap;\
}\
@font-face {\
  font-family: 'Atkinson Hyperlegible Mono';\
  src: url('${base}assets/fonts/AtkinsonHyperlegibleMono-Regular.otf') format('opentype');\
  font-weight: 400; font-style: normal; font-display: swap;\
}\
pre, code, .hljs, .leftbar { font-family: 'Atkinson Hyperlegible Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Segoe UI Mono", "Courier New", monospace !important; }\
body { font-family: 'Atkinson Hyperlegible Next', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }\
`;

      const style = document.createElement('style');
      style.appendChild(document.createTextNode(css));
      document.head.appendChild(style);
    } catch (e) { console.warn('Font injection failed', e); }
  })();
</script>

<script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    mermaid.initialize({ startOnLoad: true });
  });
</script>
